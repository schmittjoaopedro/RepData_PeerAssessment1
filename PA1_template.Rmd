---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document: 
    keep_md: true 
---

For this analisys, the followed libraries are required

```{r libraries,results="hide",message=FALSE}
library(dplyr)
```

## Loading and preprocessing the data

First, checks if the activity.csv file exists, if the file does not exists, then
unzip the activity.zip file, to finally load the activity.csv in the actDt variable.
Then convert the column date that is as factor to the date format, and show a summary 
about the data.


```{r}
if(!file.exists("activity.csv")) {
  unzip("activity.zip")
}
actDt <- read.csv("activity.csv")
actDt$date <- as.Date(actDt$date, "%Y-%m-%d")
summary(actDt)
```


## The mean of the total number of steps taken per day

For each day we group all measurements and sum all steps ignorign NA's values, after grouper the values we make a histogram of the frequencies of days per steps. The mean of steps per day it in red and the median of steps per day it in blue.

```{r}
stepsPerDay <- actDt %>% 
  group_by(date) %>% 
  summarise_each(funs(sum(steps, na.rm = T))) %>% 
  select(date, steps)

stepsMean <- round(mean(stepsPerDay$steps, na.rm = T), 2)
stepsMedian <- median(stepsPerDay$steps, na.rm = T)
hist(stepsPerDay$steps, 
     xlab = "Steps per day",
     ylab = "Frequency",
     main = "Frequency of total steps per day.", 
     col = "gray")
abline(v = stepsMean, col = "red", lwd = 3)
abline(v = stepsMedian, col = "blue", lwd = 3)
legend('topright', 
       legend = c(paste("Mean ", stepsMean), paste("Median ",stepsMedian)), 
       fill = c("red","blue"))
```

## What is the average daily activity pattern?

This graph was made ignoring the missed values, the time series indicate the average of steps for each 5 minutes interval, the red point in the graph indicate the max steps count of a single interval in the all day.

```{r}
stepsPerInterval <- actDt %>%
    group_by(interval) %>%
    summarise_each(funs(mean(steps, na.rm = T))) %>%
    as.data.frame()

maxStepPerInterval <- stepsPerInterval[which.max(stepsPerInterval$steps),]

plot(stepsPerInterval$interval, 
     stepsPerInterval$steps, 
     type = "l", 
     xlab = "5 minutes interval", 
     ylab = "Average steps", 
     main = "Steps average per 5 minutes interval")
points(maxStepPerInterval, col = "red", pch = 16)
legend("topright", 
       legend = paste("Max steps is ", round(maxStepPerInterval$steps, 2)), 
       pch = 16, 
       pt.bg = "red", 
       bty = "n", 
       col = "red")
```

## Imputing missing values

This dataset has some missing values for the total of the `r count(actDt)` records. How we can see, only the steps has missing values, the following code demonstrate the percentage of NA's for each variable.

```{r}
nasSummarie <- data.frame(
    Missing.Amount = c(
        sum(is.na(actDt$steps)),
        sum(is.na(actDt$date)),
        sum(is.na(actDt$interval))
    ),
    Missing.Percentage = c(
        mean(is.na(actDt$steps)) * 100,
        mean(is.na(actDt$date)) * 100,
        mean(is.na(actDt$interval)) * 100
    )
)
nasSummarie
```

## Are there differences in activity patterns between weekdays and weekends?
